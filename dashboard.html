<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syndicate | Dashboard</title>
    <style>
        :root {
            --apple-blue: #0071e3;
            --bg-light: #f5f5f7;
            --text-main: #1d1d1f;
            --text-sub: #86868b;
            --success: #34c759;
            --ultra-gold: #d4af37;
        }

        body {
            margin: 0; font-family: -apple-system, sans-serif;
            background-color: var(--bg-light); color: var(--text-main);
            display: flex; min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 260px; background: white; border-right: 1px solid #e5e5e7;
            display: flex; flex-direction: column; padding: 30px 20px;
            position: fixed; height: 100vh;
        }
        .sidebar h2 { font-size: 18px; font-weight: 800; margin-bottom: 40px; letter-spacing: 1px; }
        .nav-item { 
            padding: 12px; margin-bottom: 5px; border-radius: 10px; 
            color: var(--text-sub); font-size: 14px; text-decoration: none; 
            cursor: pointer; border: none; background: none; text-align: left; width: 100%;
        }
        .nav-item.active { background: #f0f7ff; color: var(--apple-blue); font-weight: 600; }

        .main-content { margin-left: 300px; padding: 40px; flex-grow: 1; max-width: 1000px; }

        /* Tabs Logic */
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Stats Cards */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 25px 0; }
        .stat-card { background: white; padding: 25px; border-radius: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.03); }
        .stat-card h3 { font-size: 11px; text-transform: uppercase; color: var(--text-sub); margin: 0; }
        .stat-card p { font-size: 24px; font-weight: 700; margin-top: 10px; }

        /* Learning Content Styles */
        .plan-card { background: white; padding: 40px; border-radius: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.03); }
        .step { margin-bottom: 30px; padding-left: 20px; border-left: 3px solid var(--apple-blue); }
        .step h3 { margin: 0 0 10px 0; color: var(--apple-blue); }
        .cashflow-box { background: #1d1d1f; color: white; padding: 25px; border-radius: 20px; margin-top: 20px; text-align: center; }
        
        .badge { padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 700; margin-bottom: 10px; display: inline-block; border: 1px solid var(--apple-blue); color: var(--apple-blue); }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2>■ SYNDICATE</h2>
        <button class="nav-item active" onclick="showTab('dashboard')">Dashboard</button>
        <button class="nav-item" onclick="showTab('learning')">Learning Content</button>
        <button class="nav-item">Marketing Assets</button>
        <div style="margin-top: auto;">
            <button onclick="handleLogout()" class="nav-item" style="color: #ff3b30;">Logout</button>
        </div>
    </div>

    <div class="main-content">
        
        <div id="dashboard" class="tab-content active">
            <div class="badge">PRO MEMBER</div>
            <h1>Welcome back, <span id="userName">User</span></h1>
            
            <div class="stats-grid">
                <div class="stat-card"><h3>Earnings</h3><p style="color: var(--success);">$<span id="userBalance">0.00</span></p></div>
                <div class="stat-card"><h3>Trial Progress</h3><p>Day <span id="dayNum">1</span> / 5</p></div>
                <div class="stat-card"><h3>Invite Code</h3><p id="myCode" style="font-size: 18px;">---</p></div>
            </div>

            <div class="plan-card" style="text-align: center;">
                <h2>Your Daily Task</h2>
                <p style="color: var(--text-sub);">Go to "Learning Content" to see the full strategy and start setting.</p>
                <button class="nav-item" onclick="showTab('learning')" style="background: var(--apple-blue); color: white; text-align: center; display: inline-block; width: auto; padding: 12px 30px;">Open Strategy Plan</button>
            </div>
        </div>

        <div id="learning" class="tab-content">
            <h1>The Syndicate Plan</h1>
            <p style="color: var(--text-sub); margin-bottom: 40px;">Follow these steps to generate your first commissions.</p>

            <div class="plan-card">
                <div class="step">
                    <h3>Step 1: The "Setting" Phase</h3>
                    <p>Your goal is to bring new clients to our platform. Send them to <b>index.html</b> and give them your <b>Invite Code</b>. Every time someone joins through you, they become your lifetime client.</p>
                </div>

                <div class="step">
                    <h3>Step 2: Trial & Education</h3>
                    <p>During these 5 days, your clients pay $5 (which goes to the platform admin). You teach them how to use the dashboard and how they can get their own code. At this stage, your earnings are tracked as "Pending".</p>
                </div>

                <div class="step">
                    <h3>Step 3: The Ultra Upgrade ($199)</h3>
                    <p>After the 5-day trial, you must upgrade to <b>Ultra Client</b> for $199. This unlocks the <b>Cash Flow Effect</b>. You will now receive <b style="color: var(--success);">90% ($179.10)</b> of every upgrade your clients make!</p>
                </div>

                <div class="cashflow-box">
                    <h2 style="margin: 0;">The Cash Flow Effect</h2>
                    <p>You Set → They Join ($5) → They Upgrade ($199) → <span style="color: var(--success);">You get $179.10</span></p>
                </div>
                
                <p style="margin-top: 30px; font-size: 14px; text-align: center;"><b>Pro Tip:</b> To get your first clients, you must be very smart. Start by reaching out to your network today.</p>
            </div>
        </div>

    </div>

    <script type="module">
        // Firebase Logic (same as before)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAYO0J1GWXIowL0c2mu4x8h6k5R6BVG26U",
            authDomain: "syndicate-protocol-48f8c.firebaseapp.com",
            projectId: "syndicate-protocol-48f8c",
            storageBucket: "syndicate-protocol-48f8c.firebasestorage.app",
            messagingSenderId: "47535029358",
            appId: "1:47535029358:web:9990ca7fad4f0ed72bba7f"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Tab Switching Function
        window.showTab = (tabId) => {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
            
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        };

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                const userDoc = await getDoc(doc(db, "members", user.uid));
                if (userDoc.exists()) {
                    const data = userDoc.data();
                    document.getElementById('userName').innerText = data.firstName;
                    document.getElementById('userBalance').innerText = (data.balance || 0).toFixed(2);
                    document.getElementById('myCode').innerText = data.myInviteCode;
                }
            } else { window.location.href = "login.html"; }
        });

        window.handleLogout = () => signOut(auth).then(() => window.location.href = "login.html");
    </script>
</body>
</html>
